(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{444:function(t,_,v){"use strict";v.r(_);var d=v(2),r=Object(d.a)({},(function(){var t=this,_=t._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("p",[t._v("客户端向服务端发送SUBSCRIBE报文用于创建一个或多个订阅。每个订阅注册客户端关心的一个或多个主题。为了将应用消息转发给与那些订阅匹配的主题，服务端发送PUBLISH报文给客户端。SUBSCRIBE报文也（为每个订阅）指定了最大的QoS等级，服务端根据这个发送应用消息给客户端。")]),t._v(" "),_("h3",{attrs:{id:"_3-8-1-固定报头"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-1-固定报头"}},[t._v("#")]),t._v(" 3.8.1 固定报头")]),t._v(" "),_("h5",{attrs:{id:"图例-3-20-subscribe报文固定报头"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#图例-3-20-subscribe报文固定报头"}},[t._v("#")]),t._v(" 图例 3.20 – SUBSCRIBE报文固定报头")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[t._v("Bit")])]),t._v(" "),_("th",[_("strong",[t._v("7")])]),t._v(" "),_("th",[_("strong",[t._v("6")])]),t._v(" "),_("th",[_("strong",[t._v("5")])]),t._v(" "),_("th",[_("strong",[t._v("4")])]),t._v(" "),_("th",[_("strong",[t._v("3")])]),t._v(" "),_("th",[_("strong",[t._v("2")])]),t._v(" "),_("th",[_("strong",[t._v("1")])]),t._v(" "),_("th",[_("strong",[t._v("0")])])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("byte 1")]),t._v(" "),_("td",[t._v("MQTT控制报文类型 (8)")]),t._v(" "),_("td",[t._v("保留位")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v("byte 2")]),t._v(" "),_("td",[t._v("剩余长度")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")])])]),t._v(" "),_("table",{staticStyle:{"text-align":"center"}},[_("tr",[_("td",{attrs:{align:"center"}},[_("strong",[t._v("Bit")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("7")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("6")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("5")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("4")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("3")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("2")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("1")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("0")])])]),t._v(" "),_("tr",[_("td",[t._v("byte 1")]),t._v(" "),_("td",{attrs:{colspan:"4",align:"center"}},[t._v("MQTT控制报文类型 (8)")]),t._v(" "),_("td",{attrs:{colspan:"4",align:"center"}},[t._v("保留位")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("1")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v("byte 2")]),t._v(" "),_("td",{attrs:{colspan:"8",align:"center"}},[t._v("剩余长度")])])]),t._v(" "),_("p",[t._v("SUBSCRIBE控制报固定报头的第3,2,1,0位是保留位，"),_("strong",[t._v("必须")]),t._v("分别设置为0,0,1,0。服务端"),_("strong",[t._v("必须")]),t._v("将其它的任何值都当做是不合法的并关闭网络连接 [MQTT-3.8.1-1]。")]),t._v(" "),_("p",[_("strong",[t._v("剩余长度字段")])]),t._v(" "),_("p",[t._v("等于可变报头的长度（2字节）加上有效载荷的长度。")]),t._v(" "),_("h3",{attrs:{id:"_3-8-2可变报头"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-2可变报头"}},[t._v("#")]),t._v(" 3.8.2可变报头")]),t._v(" "),_("p",[t._v("可变报头包含报文标识符。2.3.1提供了有关报文标识符的更多信息。")]),t._v(" "),_("h4",{attrs:{id:"可变报头非规范示例"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#可变报头非规范示例"}},[t._v("#")]),t._v(" 可变报头非规范示例")]),t._v(" "),_("p",[_("a",{attrs:{href:"#_%E5%9B%BE%E4%BE%8B_3.21_%E2%80%93"}},[t._v("图例 3.21 – 报文标识符等于10的可变报头，非规范示例")]),t._v(" 展示了报文标识符设置为10时的可变报头。")]),t._v(" "),_("h5",{attrs:{id:"图例-3-21-报文标识符等于10的可变报头-非规范示例"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#图例-3-21-报文标识符等于10的可变报头-非规范示例"}},[t._v("#")]),t._v(" 图例 3.21 – 报文标识符等于10的可变报头，非规范示例")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th"),t._v(" "),_("th",[_("strong",[t._v("描述")])]),t._v(" "),_("th",[_("strong",[t._v("7")])]),t._v(" "),_("th",[_("strong",[t._v("6")])]),t._v(" "),_("th",[_("strong",[t._v("5")])]),t._v(" "),_("th",[_("strong",[t._v("4")])]),t._v(" "),_("th",[_("strong",[t._v("3")])]),t._v(" "),_("th",[_("strong",[t._v("2")])]),t._v(" "),_("th",[_("strong",[t._v("1")])]),t._v(" "),_("th",[_("strong",[t._v("0")])])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("报文标识符")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("byte 1")]),t._v(" "),_("td",[t._v("报文标识符 MSB (0)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v("byte 2")]),t._v(" "),_("td",[t._v("报文标识符 LSB (10)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")])])])]),t._v(" "),_("h3",{attrs:{id:"_3-8-3-有效载荷"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-3-有效载荷"}},[t._v("#")]),t._v(" 3.8.3 有效载荷")]),t._v(" "),_("p",[t._v("SUBSCRIBE报文的有效载荷包含了一个主题过滤器列表，它们表示客户端想要订阅的主题。SUBSCRIBE报文有效载荷中的主题过滤器列表"),_("strong",[t._v("必须")]),t._v("是1.5.3节定义的UTF-8字符串 [MQTT-3.8.3-1]。服务端"),_("strong",[t._v("应该")]),t._v("支持包含通配符（4.7.1节定义的）的主题过滤器。如果服务端选择不支持包含通配符的主题过滤器，"),_("strong",[t._v("必须")]),t._v("拒绝任何包含通配符过滤器的订阅请求 [MQTT-3.8.3-2]。每一个过滤器后面跟着一个字节，这个字节被叫做 服务质量要求（Requested QoS）。它给出了服务端向客户端发送应用消息所允许的最大QoS等级。")]),t._v(" "),_("p",[t._v("SUBSCRIBE报文的有效载荷"),_("strong",[t._v("必须")]),t._v("包含至少一对主题过滤器 和 QoS等级字段组合。没有有效载荷的SUBSCRIBE报文是违反协议的 [MQTT-3.8.3-3]。有关错误处理的信息请查看4.8节。")]),t._v(" "),_("p",[t._v("请求的最大服务质量等级字段编码为一个字节，它后面跟着UTF-8编码的主题名，那些主题过滤器 /和QoS等级组合是连续地打包。")]),t._v(" "),_("h5",{attrs:{id:"图例-3-22-subscribe报文有效载荷格式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#图例-3-22-subscribe报文有效载荷格式"}},[t._v("#")]),t._v(" 图例 3.22 – SUBSCRIBE报文有效载荷格式")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[t._v("描述")])]),t._v(" "),_("th",[_("strong",[t._v("7")])]),t._v(" "),_("th",[_("strong",[t._v("6")])]),t._v(" "),_("th",[_("strong",[t._v("5")])]),t._v(" "),_("th",[_("strong",[t._v("4")])]),t._v(" "),_("th",[_("strong",[t._v("3")])]),t._v(" "),_("th",[_("strong",[t._v("2")])]),t._v(" "),_("th",[_("strong",[t._v("1")])]),t._v(" "),_("th",[_("strong",[t._v("0")])])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("主题过滤器")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("byte 1")]),t._v(" "),_("td",[t._v("长度 MSB")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("byte 2")]),t._v(" "),_("td",[t._v("长度 LSB")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("bytes 3..N")]),t._v(" "),_("td",[t._v("主题过滤器（Topic Filter）")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("服务质量要求（Requested QoS）")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td",[t._v("保留位")]),t._v(" "),_("td",[t._v("服务质量等级")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("byte N+1")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("X")]),t._v(" "),_("td",[t._v("X")])])])]),t._v(" "),_("table",{staticStyle:{"text-align":"center"}},[_("tr",[_("td",{attrs:{align:"center"}},[_("strong",[t._v("描述")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("7")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("6")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("5")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("4")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("3")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("2")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("1")])]),t._v(" "),_("td",{attrs:{align:"center"}},[_("strong",[t._v("0")])])]),t._v(" "),_("tr",[_("td",{attrs:{colspan:"9"}},[t._v("主题过滤器")])]),t._v(" "),_("tr",[_("td",[t._v("byte 1")]),t._v(" "),_("td",{attrs:{colspan:"8",align:"center"}},[t._v("长度 MSB")])]),t._v(" "),_("tr",[_("td",[t._v("byte 2")]),t._v(" "),_("td",{attrs:{colspan:"8",align:"center"}},[t._v("长度 LSB")])]),t._v(" "),_("tr",[_("td",[t._v("byte 3..N")]),t._v(" "),_("td",{attrs:{colspan:"8",align:"center"}},[t._v("主题过滤器（Topic Filter）")])]),t._v(" "),_("tr",[_("td",{attrs:{colspan:"9"}},[t._v("服务质量要求（Requested QoS）")])]),t._v(" "),_("tr",[_("td"),t._v(" "),_("td",{attrs:{colspan:"6",align:"center"}},[t._v("保留位")]),t._v(" "),_("td",{attrs:{colspan:"2",align:"center"}},[t._v("服务质量等级")])]),t._v(" "),_("tr",[_("td",[t._v(" byte N+1")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("0")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("X")]),t._v(" "),_("td",{attrs:{align:"center"}},[t._v("X")])])]),t._v(" "),_("p",[t._v("当前版本的协议没有用到服务质量要求（Requested QoS）字节的高六位。如果有效载荷中的任何位是非零值，或者QoS不等于0,1或2，服务端"),_("strong",[t._v("必须")]),t._v("认为SUBSCRIBE报文是不合法的并关闭网络连接 [MQTT-3-8.3-4]。")]),t._v(" "),_("h4",{attrs:{id:"有效载荷非规范示例"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#有效载荷非规范示例"}},[t._v("#")]),t._v(" 有效载荷非规范示例")]),t._v(" "),_("blockquote",[_("p",[_("a",{attrs:{href:"#_Figure_3.23_-"}},[t._v("图例 3.23 – 有效载荷字节格式非规范示例")]),t._v(" 展示了 "),_("a",{attrs:{href:"#_Table_3.4_-"}},[t._v("表格 3.5 – 有效载荷非规范示例")]),t._v(" 中简略描述的SUBSCRIBE报文的有效载荷。")])]),t._v(" "),_("h5",{attrs:{id:"表格-3-5-有效载荷非规范示例"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#表格-3-5-有效载荷非规范示例"}},[t._v("#")]),t._v(" 表格 3.5 – 有效载荷非规范示例")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("主题名")]),t._v(" "),_("th",[t._v("“a/b”")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("服务质量要求")]),t._v(" "),_("td",[t._v("0x01")])]),t._v(" "),_("tr",[_("td",[t._v("主题名")]),t._v(" "),_("td",[t._v("“c/d”")])]),t._v(" "),_("tr",[_("td",[t._v("服务质量要求")]),t._v(" "),_("td",[t._v("0x02")])])])]),t._v(" "),_("h5",{attrs:{id:"图例-3-23-有效载荷字节格式非规范示例"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#图例-3-23-有效载荷字节格式非规范示例"}},[t._v("#")]),t._v(" 图例 3.23 – 有效载荷字节格式非规范示例")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th"),t._v(" "),_("th",[_("strong",[t._v("描述")])]),t._v(" "),_("th",[_("strong",[t._v("7")])]),t._v(" "),_("th",[_("strong",[t._v("6")])]),t._v(" "),_("th",[_("strong",[t._v("5")])]),t._v(" "),_("th",[_("strong",[t._v("4")])]),t._v(" "),_("th",[_("strong",[t._v("3")])]),t._v(" "),_("th",[_("strong",[t._v("2")])]),t._v(" "),_("th",[_("strong",[t._v("1")])]),t._v(" "),_("th",[_("strong",[t._v("0")])])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("主题过滤器（Topic Filter）")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("byte 1")]),t._v(" "),_("td",[t._v("Length MSB (0)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v("byte 2")]),t._v(" "),_("td",[t._v("Length LSB (3)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")])]),t._v(" "),_("tr",[_("td",[t._v("byte 3")]),t._v(" "),_("td",[t._v("‘a’ (0x61)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")])]),t._v(" "),_("tr",[_("td",[t._v("byte 4")]),t._v(" "),_("td",[t._v("‘/’ (0x2F)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")])]),t._v(" "),_("tr",[_("td",[t._v("byte 5")]),t._v(" "),_("td",[t._v("‘b’ (0x62)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v("服务质量要求（Requested QoS）")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("byte 6")]),t._v(" "),_("td",[t._v("Requested QoS(1)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")])]),t._v(" "),_("tr",[_("td",[t._v("主题过滤器（Topic Filter）")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("byte 7")]),t._v(" "),_("td",[t._v("Length MSB (0)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v("byte 8")]),t._v(" "),_("td",[t._v("Length LSB (3)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")])]),t._v(" "),_("tr",[_("td",[t._v("byte 9")]),t._v(" "),_("td",[t._v("‘c’ (0x63)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")])]),t._v(" "),_("tr",[_("td",[t._v("byte 10")]),t._v(" "),_("td",[t._v("‘/’ (0x2F)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")])]),t._v(" "),_("tr",[_("td",[t._v("byte 11")]),t._v(" "),_("td",[t._v("‘d’ (0x64)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")])]),t._v(" "),_("tr",[_("td",[t._v("服务质量要求（Requested QoS）")]),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td"),t._v(" "),_("td")]),t._v(" "),_("tr",[_("td",[t._v("byte 12")]),t._v(" "),_("td",[t._v("Requested QoS(2)")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("0")]),t._v(" "),_("td",[t._v("1")]),t._v(" "),_("td",[t._v("0")])])])]),t._v(" "),_("h3",{attrs:{id:"_3-8-4-响应"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_3-8-4-响应"}},[t._v("#")]),t._v(" 3.8.4 响应")]),t._v(" "),_("p",[t._v("服务端收到客户端发送的一个SUBSCRIBE报文时，"),_("strong",[t._v("必须")]),t._v("使用SUBACK报文响应 [MQTT-3.8.4-1]。SUBACK报文"),_("strong",[t._v("必须")]),t._v("和等待确认的SUBSCRIBE报文有相同的报文标识符 [MQTT-3.8.4-2]。")]),t._v(" "),_("p",[t._v("允许服务端在发送SUBACK报文之前就开始发送与订阅匹配的PUBLISH报文。")]),t._v(" "),_("p",[t._v("如果服务端收到一个SUBSCRIBE报文，报文的主题过滤器与一个现存订阅的主题过滤器相同，那么"),_("strong",[t._v("必须")]),t._v("使用新的订阅彻底替换现存的订阅。新订阅的主题过滤器和之前订阅的相同，但是它的最大QoS值可以不同。与这个主题过滤器匹配的任何现存的保留消息"),_("strong",[t._v("必须")]),t._v("被重发，但是发布流程"),_("strong",[t._v("不能")]),t._v("中断 ["),_("a",{attrs:{href:"https://tools.oasis-open.org/issues/browse/MQTT-3",target:"_blank",rel:"noopener noreferrer"}},[t._v("MQTT-3"),_("OutboundLink")],1),t._v(".8.4-3]。")]),t._v(" "),_("p",[t._v("如果主题过滤器不同于任何现存订阅的过滤器，服务端会创建一个新的订阅并发送所有匹配的保留消息。")]),t._v(" "),_("p",[t._v("如果服务端收到包含多个主题过滤器的SUBSCRIBE报文，它"),_("strong",[t._v("必须")]),t._v("如同收到了一系列的多个SUBSCRIBE报文一样处理那个，除了需要将它们的响应合并到一个单独的SUBACK报文发送 [MQTT-3.8.4-4]。")]),t._v(" "),_("p",[t._v("服务端发送给客户端的SUBACK报文对每一对主题过滤器 和QoS等级都"),_("strong",[t._v("必须")]),t._v("包含一个返回码。这个返回码"),_("strong",[t._v("必须")]),t._v("表示那个订阅被授予的最大QoS等级，或者表示这个订阅失败 ["),_("a",{attrs:{href:"https://tools.oasis-open.org/issues/browse/MQTT-3",target:"_blank",rel:"noopener noreferrer"}},[t._v("MQTT-3"),_("OutboundLink")],1),t._v(".8.4-5]。服务端可以授予比订阅者要求的低一些的QoS等级。为响应订阅而发出的消息的有效载荷的QoS"),_("strong",[t._v("必须")]),t._v("是原始发布消息的QoS和服务端授予的QoS两者中的最小值。如果原始消息的QoS是1而被授予的最大QoS是0，允许服务端重复发送一个消息的副本给订阅者 ["),_("a",{attrs:{href:"https://tools.oasis-open.org/issues/browse/MQTT-3",target:"_blank",rel:"noopener noreferrer"}},[t._v("MQTT-3"),_("OutboundLink")],1),t._v(".8.4-6]。")]),t._v(" "),_("blockquote",[_("p",[_("strong",[t._v("非规范示例")]),t._v("\n对某个特定的主题过滤器，如果正在订阅的客户端被授予的最大QoS等级是1，那么匹配这个过滤器的QoS等级0的应用消息会按QoS等级0分发给这个客户端。这意味着客户端最多收到这个消息的一个副本。从另一方面说，发布给同一主题的QoS等级2的消息会被服务端降级到QoS等级1再分发给客户端，因此客户端可能会收到重复的消息副本。")]),t._v(" "),_("p",[t._v("如果正在订阅的客户端被授予的最大QoS等级是0，那么原来按QoS等级2发布给客户端的应用消息在繁忙时可能会丢失，但是服务端不应该发送重复的消息副本。发布给同一主题的 QoS等级1的消息在传输给客户端时可能会丢失或重复。")]),t._v(" "),_("p",[_("strong",[t._v("非规范评注")])]),t._v(" "),_("p",[t._v("使用QoS等级2订阅一个主题过滤器等于是说："),_("em",[t._v("我想要按照它们发布时的QoS等级接受匹配这个过滤器的消息")]),t._v(" 。这意味着，确定消息分发时可能的最大QoS等级是发布者的责任，而订阅者可以要求服务端降低QoS到更适合它的等级。")])])])}),[],!1,null,null,null);_.default=r.exports}}]);